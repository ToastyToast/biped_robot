<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro" name="biped">
    <material name="red">
        <color rgba="0.8 0 0 1"/>
    </material>

    <material name="green">
        <color rgba="0 0.8 0 1"/>
    </material>

    <material name="blue">
        <color rgba="0 0 0.8 1"/>
    </material>

    <material name="white">
        <color rgba="1 1 1 1" />
    </material>

    <material name="black">
        <color rgba="0 0 0 1" />
    </material>

    <link name="base_link">
    </link>

    <xacro:macro name="biped_leg" params="parent_link prefix reflect">
        <link name="${prefix}_pelvis_yaw_link">
        </link>

        <link name="${prefix}_pelvis_roll_link">
        </link>

        <link name="${prefix}_pelvis_pitch_link">
            <visual>
                <origin xyz="0 0 -0.25"/>
                <geometry>
                    <cylinder radius="0.02" length="0.5" />
                </geometry>
                <material name="blue"/>
            </visual>
        </link>

        <joint name="${prefix}_pelvis_yaw" type="revolute">
            <axis xyz="0 0 1" />
            <limit effort="10.0" lower="-${pi/3}" upper="${pi/3}" velocity="50.00" />
            <origin xyz="0 ${reflect*0.25} 0" rpy="0 0 0" />
            <parent link="${parent_link}" />
            <child link="${prefix}_pelvis_yaw_link" />
        </joint>

        <joint name="${prefix}_pelvis_roll" type="revolute">
            <axis xyz="1 0 0" />
            <limit effort="10.0" lower="-${pi/3}" upper="${pi/3}" velocity="50.0" />
            <origin xyz="0 0 0" rpy="0 0 0" />
            <parent link="${prefix}_pelvis_yaw_link" />
            <child link="${prefix}_pelvis_roll_link" />
        </joint>

        <joint name="${prefix}_pelvis_pitch" type="revolute">
            <axis xyz="0 1 0" />
            <limit effort="10.0" lower="-${pi/3}" upper="${pi/3}" velocity="50.0" />
            <origin xyz="0 0 0" rpy="0 0 0" />
            <parent link="${prefix}_pelvis_roll_link" />
            <child link="${prefix}_pelvis_pitch_link" />
        </joint>

        <link name="${prefix}_knee_pitch_link">
            <visual>
                <origin xyz="0 0 -0.25"/>
                <geometry>
                    <cylinder radius="0.02" length="0.5" />
                </geometry>
                <material name="red"/>
            </visual>
        </link>

        <joint name="${prefix}_knee_pitch" type="revolute">
            <axis xyz="0 1 0" />
            <limit effort="10.0" lower="0" upper="${pi/2}" velocity="50.0" />
            <origin xyz="0 0 -0.5" rpy="0 0 0" />
            <parent link="${prefix}_pelvis_pitch_link" />
            <child link="${prefix}_knee_pitch_link" />
        </joint>

        <link name="${prefix}_ankle_pitch_link">
        </link>

        <joint name="${prefix}_ankle_pitch" type="revolute">
            <axis xyz="0 1 0" />
            <limit effort="10.0" lower="-${pi/3}" upper="${pi/3}" velocity="50.0" />
            <origin xyz="0 0 -0.5" rpy="0 0 0" />
            <parent link="${prefix}_knee_pitch_link" />
            <child link="${prefix}_ankle_pitch_link" />
        </joint>

        <link name="${prefix}_ankle_roll_link">
            <visual>
                <origin xyz="0.075 0 -0.02"/>
                <geometry>
                    <box size="0.3 0.1 0.02" />
                </geometry>
                <material name="green" />
            </visual>
        </link>

        <joint name="${prefix}_ankle_roll" type="revolute">
            <axis xyz="1 0 0" />
            <limit effort="10.0" lower="-${pi/3}" upper="${pi/3}" velocity="50.0" />
            <origin xyz="0 0 0" rpy="0 0 0" />
            <parent link="${prefix}_ankle_pitch_link" />
            <child link="${prefix}_ankle_roll_link" />
        </joint>

        <link name="${prefix}_ankle">
        </link>

        <joint name="${prefix}_ankle_fixed" type="fixed">
            <origin xyz="0 0 0" rpy="0 0 0" />
            <parent link="${prefix}_ankle_roll_link" />
            <child link="${prefix}_ankle" />
        </joint>
    </xacro:macro>

    <xacro:macro name="biped_left_leg" params="parent_link">
        <xacro:biped_leg prefix="l" parent_link="${parent_link}" reflect="1" />
    </xacro:macro>

    <xacro:macro name="biped_right_leg" params="parent_link">
        <xacro:biped_leg prefix="r" parent_link="${parent_link}" reflect="-1" />
    </xacro:macro>

    <xacro:biped_left_leg parent_link="base_link" />
    <xacro:biped_right_leg parent_link="base_link" />
</robot>